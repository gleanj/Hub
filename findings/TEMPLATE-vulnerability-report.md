# Vulnerability Report Template

## Basic Information

**Report ID**: [Auto-generated or your tracking ID]
**Date Found**: [YYYY-MM-DD]
**Researcher**: [Your name]
**Severity**: [Critical / High / Medium / Low]
**Status**: [New / In Progress / Ready to Submit]

---

## Vulnerability Summary

**Title**: [Concise, descriptive title]

**Vulnerability Type**: 
- [ ] Cross-Portal IDOR
- [ ] Same-Portal IDOR  
- [ ] Authentication Bypass
- [ ] Authorization Bypass
- [ ] Cross-Site Scripting (XSS)
- [ ] SQL Injection
- [ ] Server-Side Request Forgery (SSRF)
- [ ] Remote Code Execution
- [ ] Sensitive Data Exposure
- [ ] Other: [Specify]

**Affected Asset**: 
- Domain: [e.g., app.hubspot.com, api.hubapi.com]
- Endpoint: [Specific URL or API endpoint]
- Portal ID (if relevant): [Portal ID]

**CVSS Score**: [Calculate at https://www.first.org/cvss/calculator/3.1]

---

## Executive Summary

[2-3 sentence summary of the vulnerability and its impact]

Example:
"An insecure direct object reference (IDOR) vulnerability allows an authenticated user in Portal A to access and modify contact records from Portal B by manipulating the portalId parameter. This leads to unauthorized access to sensitive customer data including PII/PHI information across different customer portals."

---

## Vulnerability Details

### Description

[Detailed technical description of the vulnerability. Explain:
- What the vulnerability is
- Where it exists (exact endpoint/feature)
- Why it exists (missing validation, etc.)
- How it can be exploited]

Example:
"The /contacts/v1/contact/vid/{vid}/profile endpoint does not properly validate that the requested contact belongs to the authenticated user's portal. By manipulating the vid parameter and adding a portalId parameter, an attacker can retrieve contact information from any portal, bypassing authorization checks."

### Root Cause

[Technical explanation of why the vulnerability exists]

Example:
"The API endpoint performs authentication (verifies the user is logged in) but fails to perform proper authorization (verify the user has permission to access the specific contact). The portal ownership check is missing or can be bypassed."

---

## Impact Assessment

### Business Impact
- [ ] Unauthorized access to customer data
- [ ] Data breach / data leakage
- [ ] Account takeover
- [ ] Financial loss
- [ ] Regulatory compliance violation (GDPR, HIPAA, etc.)
- [ ] Reputation damage
- [ ] Other: [Specify]

### Technical Impact
- [ ] Cross-portal data access
- [ ] Privilege escalation
- [ ] Remote code execution
- [ ] Data modification/deletion
- [ ] Service disruption
- [ ] Other: [Specify]

### Affected Users/Data
- Number of users affected: [Estimate]
- Type of data exposed: [PII, PHI, Financial, etc.]
- Scope: [Single portal, All portals, Specific features]

### Attack Scenario

[Describe a realistic attack scenario]

Example:
"An attacker creates a free trial HubSpot account. They enumerate contact VIDs from their own portal and then systematically access contacts from other portals by modifying the vid parameter. Within hours, they extract thousands of contact records containing names, emails, phone numbers, and custom sensitive fields from legitimate HubSpot customers."

---

## Proof of Concept

### Prerequisites
- [ ] HubSpot account (free trial sufficient)
- [ ] API key or valid session
- [ ] [Other requirements]

### Environment Setup
```
Portal A (Victim):
- Portal ID: [ID]
- Contains contact with VID: [VID]
- Contact has sensitive data: [Describe]

Portal B (Attacker):
- Portal ID: [ID]
- API Key: [Masked: xxxxxx...]
```

### Reproduction Steps

**Step 1**: [Action]
```
Details or command
```

**Step 2**: [Action]
```
Details or command
```

**Step 3**: [Observe result]
```
Expected: [What should happen normally]
Actual: [What actually happens - the vulnerability]
```

### Request/Response Evidence

**Malicious Request:**
```http
GET /contacts/v1/contact/vid/[VICTIM_VID]/profile?portalId=[VICTIM_PORTAL] HTTP/2
Host: api.hubapi.com
Authorization: Bearer [ATTACKER_TOKEN]
User-Agent: Mozilla/5.0
Accept: application/json
```

**Vulnerable Response:**
```http
HTTP/2 200 OK
Content-Type: application/json
Content-Length: 1234

{
  "vid": [VICTIM_VID],
  "properties": {
    "firstname": {
      "value": "John"
    },
    "lastname": {
      "value": "Doe"
    },
    "email": {
      "value": "john.doe@victim-company.com"
    },
    "super_secret": {
      "value": "SENSITIVE_DATA_HERE"
    }
  },
  "portal-id": [VICTIM_PORTAL]
}
```

### Screenshots

[Attach screenshots showing:]
1. Burp Suite request/response
2. Vulnerability execution
3. Sensitive data accessed
4. Any other relevant visual proof

**Screenshot 1**: [Description]
- File: `screenshot-1-request.png`

**Screenshot 2**: [Description]  
- File: `screenshot-2-response.png`

### Video Demonstration

[If applicable, link to video demonstration]
- Video: `poc-video.mp4`
- Duration: [X minutes]

---

## Recommended Remediation

### Immediate Fix (Short-term)

[Quick fix that can be implemented immediately]

Example:
"Add server-side validation to ensure the requested contact's portal ID matches the authenticated user's portal ID before returning data."

**Pseudo-code:**
```python
def get_contact(vid, authenticated_user):
    contact = database.get_contact(vid)
    
    # Add this check:
    if contact.portal_id != authenticated_user.portal_id:
        return 403  # Forbidden
    
    return contact
```

### Long-term Fix (Strategic)

[More comprehensive fix addressing root cause]

Example:
"Implement a centralized authorization service that validates all portal-scoped resource access. Use portal-scoped database queries that inherently prevent cross-portal access."

### Defense in Depth

Additional security layers:
- [ ] Rate limiting on sensitive endpoints
- [ ] Audit logging for cross-portal access attempts
- [ ] Web Application Firewall (WAF) rules
- [ ] Monitoring and alerting
- [ ] Regular authorization testing

---

## Additional Context

### Similar Vulnerabilities

[Reference any similar issues found in the same or related features]

### Affected API Versions
- [ ] v1
- [ ] v2
- [ ] v3
- [ ] All versions

### Discovered During
- [ ] Manual testing
- [ ] Automated scanning
- [ ] Code review
- [ ] CTF challenge

### Related Issues/CVEs

[Any related CVEs or public vulnerabilities]

---

## References

### External Resources
- CWE: [e.g., CWE-639: Authorization Bypass Through User-Controlled Key]
- OWASP: [e.g., A01:2021 â€“ Broken Access Control]
- CVSS Calculator: https://www.first.org/cvss/calculator/3.1
- [Any other relevant references]

### Internal Documentation
- HubSpot API Docs: [Relevant section]
- Bug Bounty Program: [Link to program page]

---

## Attachments

- [ ] Burp Suite project file: `finding-[ID].burp`
- [ ] Request/response logs: `logs/`
- [ ] Screenshots: `screenshots/`
- [ ] Video PoC: `video/`
- [ ] Exploit script: `exploit.py`

---

## Submission Checklist

Before submitting:
- [ ] Verified vulnerability is in scope
- [ ] Tested on latest version
- [ ] Confirmed it's not a duplicate
- [ ] Included clear reproduction steps
- [ ] Provided attack scenario
- [ ] Documented business impact
- [ ] Included recommended fix
- [ ] Attached all evidence
- [ ] Followed responsible disclosure
- [ ] Reviewed for sensitive information in attachments

---

## Notes

[Any additional notes, observations, or context]

---

## Timeline

- **[Date]**: Vulnerability discovered
- **[Date]**: Initial testing completed
- **[Date]**: Proof of concept developed
- **[Date]**: Report drafted
- **[Date]**: Submitted to HubSpot
- **[Date]**: Acknowledged by HubSpot
- **[Date]**: Triaged/validated
- **[Date]**: Fixed by HubSpot
- **[Date]**: Bounty awarded
